<odoo>
  <template id="report_blank_pdf_template">
    <t t-set="doc" t-value="docs"/>
    <t t-set="company" t-value="env['res.company'].search([], limit=1)" />
    <t t-call-assets="web.report_assets_common" t-js="false"/>
    <main class="page" style="padding: 30px; font-family: Arial, sans-serif; font-size: 12px;">

      <!-- Header -->
      <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
        <tr>
          <td style="width: 30%; vertical-align: middle;">
            <t t-if="doc.project_id.image">
              <img t-att-src="'data:image/png;base64,%s' % doc.project_id.image.decode('utf-8')" style="max-height: 80px;" />
            </t>
          </td>
          <td style="width: 40%; text-align: center; vertical-align: middle;">
            <h2 style="margin: 0; font-size: 18px;">Home Quality Inspection Report</h2>
          </td>
          <td style="width: 30%; text-align: right; vertical-align: middle;">
            <t t-if="company.favicon">
              <img t-att-src="'data:image/png;base64,%s' % company.favicon.decode('utf-8')" style="max-height: 60px;" />
            </t>
          </td>
        </tr>
      </table>

      <!-- Project Info -->
      <table style="width: 100%; margin-bottom: 10px;">
        <tr><td><strong>Project:</strong> <t t-esc="doc.project_id.name or ''"/></td></tr>
        <tr>
          <td>
            <strong>Tower:</strong> <t t-esc="doc.tower_id.name or ''"/> -
            <strong>Flat:</strong> <t t-esc="doc.flat_id.name or ''"/>
          </td>
        </tr>
      </table>

      <!-- Report Name -->
      <table style="width: 100%; margin-bottom: 20px;">
        <tr>
          <td style="background-color: #f7f7f7; padding: 10px; border-left: 5px solid #4CAF50;">
            <span style="font-size: 14px; font-weight: bold; color: #333;">Report Name: </span>
            <span style="font-size: 14px; color: #000;"><t t-esc="doc.name or ''"/></span>
          </td>
        </tr>
      </table>

      <!-- Observations -->
      <t t-foreach="doc.sv_location_ids" t-as="loc">
        <t t-if="loc.svb_location_ids">
          <h3 style="margin-top: 20px; color: #2E7D32;">Location - <t t-esc="loc.name or ''"/></h3>

          <table class="table table-sm" style="width: 100%; border-collapse: collapse; font-size: 12px;" border="1">
            <thead>
              <tr style="background-color: #e0e0e0;">
                <th style="padding: 6px;">Photo</th>
                <th style="padding: 6px;">Issue Category</th>
                <th style="padding: 6px; width: 120px;">Issue</th>
                <th style="padding: 6px;">Remarks</th>
                <th style="padding: 6px;">Status</th>
              </tr>
            </thead>
            <tbody>
              <t t-foreach="loc.svb_location_ids" t-as="obs">
                <tr>
                  <!-- Images -->
                  <td style="padding: 5px;">
                    <t t-foreach="obs.observation_image_ids" t-as="img">
                      <t t-if="img.maker_uploaded_img">
                        <img t-att-src="'data:image/png;base64,%s' % img.maker_uploaded_img.decode('utf-8')" style="max-width: 80px; max-height: 80px; margin-bottom: 5px;" /><br/>
                      </t>
                      <t t-if="img.checker_uploaded_img">
                        <img t-att-src="'data:image/png;base64,%s' % img.checker_uploaded_img.decode('utf-8')" style="max-width: 80px; max-height: 80px; margin-bottom: 5px;" /><br/>
                      </t>
                    </t>
                  </td>

                  <!-- Category + Impact -->
    <td style="padding: 5px;">
  <div style="font-weight: bold;"><t t-esc="obs.issue_category_id.name or ''"/></div>
  <br/>

  <div style="margin-top: 5px; font-size: 10px;">
    <div style="font-weight: bold; margin-bottom: 3px;">Impact</div>
 
    <table style="border-collapse: collapse; margin-left: 0;">

      <tr>
        <!-- All bars now have the same width -->
        
        <td style="padding: 0 4px; text-align: left;">
          <div t-att-style="'width: 25px; height: 6px; background-color: %s; border-radius: 2px;' % (
                '#FFCF00' if obs.impact == 'low' else '#D9D9D9')"></div>
          </td>
       
          <td style="padding: 0 4px; text-align: left;">
            <div t-att-style="'width: 25px; height: 6px; background-color: %s; border-radius: 2px;' % (
                '#FFAE00' if obs.impact == 'medium' else '#D9D9D9')"></div>
          </td>
      
          <td style="padding: 0 4px; text-align: left;">
            <div t-att-style="'width: 25px; height: 6px; background-color: %s; border-radius: 2px;' % (
                '#FF1D00' if obs.impact == 'high' else '#D9D9D9')"></div>
        </td>
      </tr>
      <tr>
        <td style="font-size: 9px;">Low</td>
        <td style="font-size: 9px;">Medium</td>
        <td style="font-size: 9px;">High</td>
      </tr>
    </table>
  </div>
</td>


          
                  <!-- Issue -->
                <td style="padding: 5px; width: 120px; word-wrap: break-word; white-space: normal; text-align: center; vertical-align: middle;">
                  <t t-esc="obs.description or ''"/>
                </td>


        
                  <!-- Remarks -->
                
                  <td style="padding: 5px; text-align: center; vertical-align: middle;">
                    <t t-esc="obs.remark or ''"/>
                  </td>

                  <!-- Status -->
              
                  <td style="padding: 5px; font-size: 11px; text-align: center; vertical-align: middle;">
                    <t t-if="obs.state in ['in_review_by_checker', 'correction_by_maker', 're_review_by_checker', 'open', 'close']">
                      <span>Pending</span>
                    </t>
                    <t t-elif="obs.state == 'completed'">
                      <span style="color: #28A745;">Completed</span>
                    </t>
                    <t t-else="">
                      <span>-</span>
                    </t>
                  </td>

                </tr>
              </t>
            </tbody>
          </table>
        </t>
      </t>

    </main>
  </template>
</odoo>
